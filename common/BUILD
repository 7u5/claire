gen_rule(
    name = 'gen_escape_table',
    cmd = 'python claire/common/strings/generate_escape_tables.py --install_dir=$BUILD_DIR/claire/common',
    outs = ['EscapeTables.cc']
)

cc_library(
    name = 'claire_common',
    srcs = [
        './base/Exception.cc',
        './base/StackTrace.cc',
        './events/Channel.cc',
        './events/EventLoop.cc',
        './events/EventLoopThread.cc',
        './events/EventLoopThreadPool.cc',
        './events/SignalSet.cc',
        './events/TimeoutQueue.cc',
        './events/poller/EPollPoller.cc',
        './files/FileUtil.cc',
        './logging/LogBuffer.cc',
        './logging/LogFile.cc',
        './logging/LogMessage.cc',
        './logging/LogStream.cc',
        './logging/Logger.cc',
        './logging/Logging.cc',
        './metrics/BucketRanges.cc',
        './metrics/Counter.cc',
        './metrics/CounterProvider.cc',
        './metrics/CounterSampler.cc',
        './metrics/Histogram.cc',
        './metrics/HistogramRecorder.cc',
        './metrics/HistogramSamples.cc',
        './metrics/SampleVector.cc',
        './protobuf/ProtobufIO.cc',
        './strings/StringPiece.cc',
        './strings/StringPrintf.cc',
        './strings/StringPrintf.cc',
        './strings/UriEscape.cc',
        './symbolizer/Dwarf.cc',
        './symbolizer/Elf.cc',
        './symbolizer/Symbolizer.cc',
        './system/ThisProcess.cc',
        './threading/Mutex.cc',
        './threading/ThisThread.cc',
        './threading/Thread.cc',
        './threading/ThreadPool.cc',
        './time/Timestamp.cc',
        './tracing/Trace.cc',
        './tracing/TraceContext.cc',
        './tracing/TraceRecorder.cc',
        './tracing/Tracing.cc',
        'EscapeTables.cc',
    ],
    deps = [':gen_escape_table', '//thirdparty/gflags:gflags', '#pthread', '#rt'],
    extra_cppflags = '-std=c++0x'
)
